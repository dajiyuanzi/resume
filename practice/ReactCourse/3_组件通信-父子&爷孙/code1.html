<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Rabbit and Turtle</title>
  <script src="https://cdn.bootcss.com/react/16.4.0/umd/react.production.min.js"></script>
  <script src="https://cdn.bootcss.com/react-dom/16.4.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.staticfile.org/babel-standalone/6.26.0/babel.min.js"></script>
</head>
<style>
.header{
  display: flex;
  justify-content: center;
}
.track{
  border-bottom: 1px solid black;
}
*{
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}
.player{/*åŠ¨ç”»æ›´å¹³æ»‘ï¼Œæ¯æ¬¡æ’­æ”¾éƒ½è¦æœ‰1sæ—¶é•¿ ä¸”åŒ€é€Ÿ(çº¿æ€§)*/
  transition: all 1s linear;
}
body{
  padding: 40px;
}
.playground{
  border: 1px solid black;
  background: green;
}
</style>

<body>
  <div id="root"></div>
</body>

<script type="text/babel">
// function App() {
//   let t0 = new Date()
//   let success1 = ()=>{
//     console.log('å…”å­è·‘å®Œäº†ï¼Œç”¨æ—¶ï¼š')
//     console.log(new Date()-t0)
//   }
//   let success2 = ()=>{
//     console.log('ä¹Œé¾Ÿè·‘å®Œäº†ï¼Œç”¨æ—¶')
//     console.log(new Date()-t0)
//   }
//   return (
//     <div>
//       <div class="header">  
//         <Time1/>
//         <Judge/>
//         <Time2/>
//       </div>
//       <Track1 success={success1} />
//       <Track2 success={success2} />
//     </div>
//   )
// }
//å¦‚æœåœ¨æ•°æ®æ›´æ–°åï¼ŒæŠŠæ•°æ®å†æ¸²æŸ“åˆ° å·²ç»æ¸²æŸ“çš„ç»„ä»¶Time1&Time2ä¸Šï¼Œè¿™ä¸ªæ˜¯ å‡½æ•°ä¸èƒ½æ”¯æŒçš„ï¼Œæ‰€ä»¥è¦ç”¨â€œç±»â€æ¥å°è£…
class App extends React.Component{
  constructor(){
    super()
    this.state = {
      result1: 0, //rabit time-cost
      result2: 0  //turtle time-cost
    }
    this.t0 = new Date() //åœ¨æ­¤thisç‰¹æŒ‡ å±äºAppç±»çš„å®ä¾‹ çš„è‡ªèº«ç¯å¢ƒï¼Œthis.xxxç‰¹æŒ‡ å®ä¾‹ç¯å¢ƒä¸­çš„å˜é‡ï¼Œè€Œä¸æ˜¯ä¼ å‚(å½¢å‚)æˆ–éšæ„çš„ä¸´æ—¶å˜é‡
  }
  success1(x){
    console.log(x)
    console.log('å…”å­è·‘å®Œäº†ï¼Œç”¨æ—¶ï¼š')
    let r1 = new Date() - this.t0
    this.setState({
      result1: r1
    })
  }
  success2(x){
    console.log(x)
    console.log('ä¹Œé¾Ÿè·‘å®Œäº†ï¼Œç”¨æ—¶')
    let r2 = new Date() - this.t0
    this.setState({
      result2: r2
    })
  }
  render(){
    return (
      <div>
        <div class="header">  
          <Time1 result={this.state.result1} />
          <Judge/>
          <Time2 result={this.state.result2} />
        </div>
        <Playground 
          success1={this.success1.bind(this)}  /*bind(this)æ˜¯ å‡½æ•°è¢«è°ƒç”¨æ—¶ æ‰€å¤„çš„context*/
          success2={this.success2.bind(this)}
        />
      </div>
    )
  }
}
//çˆ¶å­ç»„ä»¶çš„é€šä¿¡
//(çˆ¶->å­)ï¼šAppæ˜¯çˆ¶ï¼ŒPlayground(Track1&2)æ˜¯å­ï¼Œçˆ¶ç»„ä»¶ä¼ ä¸€ä¸ª å›è°ƒå‡½æ•° ç»™å­ç»„ä»¶(è¿™è¦ç”¨bind)ï¼›(å³ ç›´æ¥æ”¾åœ¨propsé‡Œ)
//(å­->çˆ¶)ï¼šå­ç»„ä»¶åœ¨æ°å½“çš„æ—¶å€™ è°ƒç”¨æ‰§è¡Œ æ­¤çˆ¶ç»„ä»¶çš„å›è°ƒå‡½æ•°ï¼ŒæŠŠå­ç»„ä»¶çš„æ•°æ® ä½œä¸ºå‚æ•° ä¼ å…¥ æ­¤callback
//å­->çˆ¶ æœ¬è´¨ä¸Šï¼šcallbackæ˜¯åœ¨çˆ¶ç»„ä»¶å®šä¹‰çš„ï¼Œä½†å´ ç”¨å­ç»„ä»¶çš„æ•°æ® è°ƒç”¨äº† ï¼ˆæœ¬è´¨ä¸Šï¼Œcallbackåªæ˜¯ä½œä¸ºå‚æ•°(æŒ‡é’ˆ)è¢«ä¼ é€ï¼Œä»å±äº å®ƒçš„å£°æ˜ä¹‹å¤„ï¼‰

//ç»„ä»¶Appå…ˆä¼ callbackç»™å­ç»„ä»¶Playgroundï¼ŒPlaygroundå†ä¼ ç»™å®ƒçš„å­ç»„ä»¶Track1&2 ï¼ˆè¿™å°±æ˜¯ çˆ·çˆ·->çˆ¸çˆ¸ï¼Œå† çˆ¸çˆ¸->å­™å­ï¼‰
//Track1&2æ˜¯å­™å­ï¼ŒPlaygroundæ˜¯çˆ¸çˆ¸ï¼ŒAppæ˜¯çˆ·çˆ·ã€‚çˆ·çˆ·->å­™å­ï¼Œå°±å…ˆ çˆ·çˆ·->çˆ¸çˆ¸ï¼Œå† çˆ¸çˆ¸->å­™å­ã€‚å¢çˆ·çˆ·->å¢å­™å­ï¼Œä»¥æ­¤ç±»æ¨ã€‚


function Playground(props){//è·‘é“
  let success1 = props.success1
  let success2 = props.success2
  return (
    <div class="playground">
      <Track1 success={success1} />
      <Track2 success={success2} />
    </div>
  )
}

function Time1(props) {
  return (
    <div>
      <h2>ğŸ‡Rabbit Time-Cost</h2>
      <div>{props.result}</div>
    </div>
  )
}

function Time2(props) {
  return (
    <div>
      <h2>ğŸ¢Turtle Time-Cost</h2>
      <div>{props.result}</div>
    </div>
  )
}

function Judge() {
  return (
    <div>ğŸ‘®â€Judge</div>
  )
}

//===========ä¸»è¦çœ‹Trackå‡½æ•°============
//å‡½æ•°æ— æ³•æœ‰è‡ªå·±çš„çŠ¶æ€æ•°æ®ï¼Œè¦ç”¨classå°è£…ï¼Œ"ç±»"æœ‰çŠ¶æ€æ•°æ®
// function Track1() {
//   return (
//     <div>
//       <div>ğŸ‡</div>
//       <div class="track"></div>
//     </div>
//   )
// }
class Track1 extends React.Component{//å…”å­çš„è·‘åŠ¨
  constructor(){
    super() //å¿…å†™

    let n = 0
    this.state = {
      style:{
        transform: `translateX(${n}%)`  //``æ˜¯JSå­—ç¬¦ä¸²æ¨¡æ¿
      }
    }
    let timerId = setInterval(() => {
      n+=25
      this.setState({
        style:{
          transform: `translateX(${n}%)`
        }  
      })
      if(n>=100){ //å¦‚æœåˆ°è¾¾(è·‘å®Œ100%è·¯ç¨‹)ï¼Œæ¸…æ‰å®šæ—¶å™¨ æ³¨ï¼šzè¿™é‡Œå¿…é¡»å†™>=100ï¼Œä¸èƒ½å†™>
        window.clearInterval(timerId)
        this.props.success('æˆ‘æ˜¯å°å…”å…”') //å‰é¢çš„ä»£ç è·‘å®Œåï¼Œæ‰§è¡Œ çˆ¶ç»„ä»¶ä¼ è¿›æ¥çš„å›è°ƒå‡½æ•°success(x)ï¼Œç›¸å½“äºå°† å­ç»„ä»¶çš„æ•°æ® ä»¥å‡½æ•°çš„å‚æ•° å‘ç»™ çˆ¶/çˆ·ç»„ä»¶ [è§Appå’ŒPlaygroundç±»]
      }
    }, 1000)
  }

  render(){
    return (
      <div>
        <div class="player" style={this.state.style}>ğŸ‡</div>
        <div class="track"></div>
      </div>
    )
  }
}

// function Track2() {
//   return (
//     <div>
//       <div>ğŸ¢</div>
//       <div class="track"></div>
//     </div>
//   )
// }
class Track2 extends React.Component{//ä¹Œé¾Ÿçš„è·‘åŠ¨
  constructor(){
    super()

    let n = 0
    this.state = {
      style:{
        transform: `translateX(${n}%)`  //``æ˜¯JSå­—ç¬¦ä¸²æ¨¡æ¿
      }
    }
    let timerId = setInterval(() => {
      n+=20
      this.setState({
        style:{
          transform: `translateX(${n}%)`
        }  
      })
      if(n>=100){ //å¦‚æœåˆ°è¾¾(è·‘å®Œ100%è·¯ç¨‹)ï¼Œæ¸…æ‰å®šæ—¶å™¨ æ³¨ï¼šzè¿™é‡Œå¿…é¡»å†™>=100ï¼Œä¸èƒ½å†™>
        window.clearInterval(timerId)
        this.props.success('æˆ‘æ˜¯å°é¾Ÿé¾Ÿ')
      }
    }, 1000)
  }

  render(){
    return (
      <div>
        <div class="player" style={this.state.style}>ğŸ¢</div>
        <div class="track"></div>
      </div>
    )
  }
}

ReactDOM.render(<App/>, document.querySelector('#root'))
</script>
</html>